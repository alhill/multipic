(this.webpackJsonpmultipic=this.webpackJsonpmultipic||[]).push([[0],{23:function(e,n,t){e.exports=t(45)},28:function(e,n,t){},45:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),i=t(18),o=t.n(i),c=(t(28),t(1)),l=t(4),u=t.n(l),s=t(9),f=t(11),m=t(10),h=t(5),p=t(19),d=t(2),g=t(3),b=t.n(g);function v(){var e=Object(c.a)(["\n    width: 25px;\n    height: 25px;\n    opacity: 0.4;\n    transition: all 300ms;\n    padding-right: 2em;\n    &:hover{\n        opacity: 0.7;\n    }\n"]);return v=function(){return e},e}function x(){var e=Object(c.a)(["\n    display: flex;\n    width: 100%;\n    justify-content: space-evenly;\n"]);return x=function(){return e},e}function w(){var e=Object(c.a)(["\n    position: absolute;\n    top: 100px;\n    min-width: 300px;\n    width: 60vw;\n    min-height: 240px;\n    border: 3px solid pink;\n    border-radius: 4px;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-evenly;\n    align-items: center;\n    background-color: rgba(255, 255, 255, 0.95);\n    padding: 1em 2em;\n    z-index: 200;\n"]);return w=function(){return e},e}function E(){var e=Object(c.a)(["\n    width: 240px;\n    height: 40px;\n    background-color: #555;\n    color: #fcfcfc;\n    border-radius: 2px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-weight: bold;\n    transition: all 100ms;\n    box-shadow: 1px 1px 0 #ccc;\n    cursor: pointer;\n    &:hover{\n        filter: brightness(0.95);\n        box-shadow: 5px 5px 0 #ccc;    \n    }\n"]);return E=function(){return e},e}function y(){var e=Object(c.a)(["\n    width: 240px;\n    height: 40px;\n    background-color: #555;\n    color: #fcfcfc;\n    border-radius: 2px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    font-weight: bold;\n    transition: all 100ms;\n    box-shadow: 1px 1px 0 #bbb;\n    cursor: pointer;\n    &:hover{\n        filter: brightness(0.95);\n        box-shadow: 5px 5px 0 #ccc;    \n    }\n"]);return y=function(){return e},e}function j(){var e=Object(c.a)(["\n    display: flex;\n    margin-bottom: 1em;\n    align-items: center;\n    label{\n        color: #555;\n        width: 200px;\n    }\n    input {\n        height: 24px;\n        padding: 6px;\n        font-family: Lexend Tera;\n        color: #555;\n        background-color: rgba(255, 255, 255, 0.7);\n        border-radius: 2px;\n        font-size: 1.3em;\n        border: none;\n        width: 100px;\n    }\n"]);return j=function(){return e},e}function O(){var e=Object(c.a)(["\n    padding: 1em;\n    margin-top: 1em;\n    border-radius: 2px;\n    background: linear-gradient(45deg, rgba(56,239,125, 0.2), rgba(17,153,142, 0.2));\n    width: calc(100% - 4em);\n"]);return O=function(){return e},e}function k(){var e=Object(c.a)(["\n    border-radius: 4px;\n    width: 100px;\n    height: 100px;\n    object-fit: cover;\n    object-position: center center;\n    margin: 0 1em 1em 0;\n    transition: all 300ms;\n    box-shadow: 1px 1px 3px 1px rgba(0, 0, 0, 0.1);    \n    &:hover{\n        filter: saturate(0.5) brightness(0.5);\n        transform: scale(1.1);\n    }\n"]);return k=function(){return e},e}function z(){var e=Object(c.a)(["\n    display: flex;\n    flex-wrap: wrap;\n    margin-top: 2em;\n"]);return z=function(){return e},e}function C(){var e=Object(c.a)(["\n    font-family: Lexend Tera;\n    color: #999;\n    font-size: 1em;\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: wrap;\n    align-items: center;\n    text-align: center;\n    justify-content: flex-end;\n    align-content: flex-end;\n    a{\n        text-decoration: none;\n        color: #666;\n        transition: all 300ms;\n        &:hover{\n            color: black;\n        }\n    }\n    p{\n        margin: 0.5em 0;\n    }\n"]);return C=function(){return e},e}function T(){var e=Object(c.a)(["\n    font-family: Lexend Tera;\n    margin-top: 0;\n    color: #555;\n"]);return T=function(){return e},e}function M(){var e=Object(c.a)(["\n    margin: 1em 0;\n    padding: 1em 0 0 0;\n    color: #666;\n    font-size: 3em;\n    font-family: Lexend Tera;\n"]);return M=function(){return e},e}function S(){var e=Object(c.a)(["\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    min-height: 100vh;\n    z-index: 100;\n    background-color: rgba(240, 240, 240, 0.9);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    span {\n        font-size: 1.8em;\n    }\n"]);return S=function(){return e},e}function R(){var e=Object(c.a)(["\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    position: relative;\n    padding-bottom: 1em;\n    height: ",";\n    overflow: hidden;\n    min-height: 100vh;\n"]);return R=function(){return e},e}var A=d.a.div(R(),(function(e){return e.working?"100vh":"auto"})),P=d.a.div(S()),B=d.a.h1(M()),I=d.a.h3(T()),L=d.a.div(C()),D=d.a.div(z()),G=d.a.img(k()),q=d.a.div(O()),F=d.a.div(j()),J=d.a.div(y()),U=d.a.label(E()),W=d.a.div(w()),H=d.a.div(x()),K=d.a.div(v()),$=function(){var e=Object(r.useRef)(),n=Object(r.useState)(),t=Object(h.a)(n,2),i=t[0],o=t[1],c=Object(r.useState)([]),l=Object(h.a)(c,2),d=l[0],g=l[1],v=Object(r.useState)(10),x=Object(h.a)(v,2),w=x[0],E=x[1],y=Object(r.useState)(35),j=Object(h.a)(y,2),O=j[0],k=j[1],z=Object(r.useState)(),C=Object(h.a)(z,2),T=C[0],M=C[1],S=Object(r.useState)({visible:!1}),R=Object(h.a)(S,2),$=R[0],_=R[1],N=function(n,t){var r=[];Object(m.a)(n).forEach((function(n,a,i){var c=new FileReader;c.readAsDataURL(n),c.onloadend=function(){var n,l;"input"===t?(r.push({original:c.result}),i.length===a+1&&(g([].concat(Object(m.a)(null!==(n=e.current)&&void 0!==n?n:[]),r)),e.current=[].concat(Object(m.a)(null!==(l=e.current)&&void 0!==l?l:[]),r))):o(c.result)}}))},Q=function(e){var n=e.bitmap.height,t=e.bitmap.width,r=n*t,a=Array(r).fill(null).map((function(n,r){var a=r%t,i=Math.trunc(r/t);return b.a.intToRGBA(e.getPixelColor(a,i))})).reduce((function(e,n){return{r:n.r+e.r,g:n.g+e.g,b:n.b+e.b}}),{r:0,g:0,b:0});return{r:Math.round(a.r/r),g:Math.round(a.g/r),b:Math.round(a.b/r)}},V=function(e,n,t,r){return n.map((function(n){return Object(f.a)({},n,{diff:X(n.avgColor,e.color)})})).sort((function(e,n){return e.diff>n.diff?1:-1}))[0].resized},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=Math.abs(e.r-n.r),r=Math.abs(e.g-n.g),a=Math.abs(e.b-n.b);return t+r+a},Y=function(e){var n=e.bitmap.height,t=e.bitmap.width;return e.crop(t>n?(t-n)/2:0,t>n?0:(n-t)/2,t>n?n:t,t>n?n:t)},Z=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;return e.resize(parseInt(n),parseInt(t))},ee=function(){var n=Object(s.a)(u.a.mark((function n(){var t,r;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Array.isArray(e.current)&&0!==(null===(t=e.current)||void 0===t?void 0:t.length)){n.next=3;break}return _({visible:!0,text:"Select input files"}),n.abrupt("return");case 3:if(i){n.next=6;break}return _({visible:!0,text:"Select reference image"}),n.abrupt("return");case 6:b.a.read(i,(function(e,n){var t=Math.trunc(n.bitmap.height/w)*O,a=Math.trunc(n.bitmap.width/w)*O;console.log({h:t,w:a}),t>5e3||a>5e3?(M(" "),_({visible:!0,text:"The dimensions of the output image with the selected reduction ratio and square size will be ".concat(a,"*").concat(t,". \nGenerating images so big can slow down your browser and even crash it.\nDo you want to continue?"),fn:function(){_({visible:!1}),r()}})):r()})),r=function(){var n=Object(s.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.current.forEach((function(n,t,r){M("Reading input pics"),b.a.read(n.original,(function(n,r){M("Processing input pics");var a=Q(r),o=Y(r),c=Z(o,O);e.current.forEach((function(n,r,o){t===r&&(e.current[t]=Object(f.a)({},e.current[t],{avgColor:a,resized:c})),o.length===t+1&&o.length===r+1&&(M("Reading reference image"),b.a.read(i,(function(n,t){var r=Math.trunc(t.bitmap.height/w),a=Math.trunc(t.bitmap.width/w),i=r*a,o=Z(t,a,r),c=Array(i).fill(null).map((function(e,n){var t=n%a,r=Math.trunc(n/a);return{x:t,y:r,color:b.a.intToRGBA(o.getPixelColor(t,r))}}));M("Comparing each pixel of the reference image with the input files");var l=c.map((function(n,t,r){return Object(f.a)({},n,{composePic:V(n,e.current,t+1,r.length)})}));M("Composing the whole image"),ne(l,a,r)})))}))}))}));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),ne=function(e,n,t){new b.a(n*O,t*O,16777215,(function(n,t){e.forEach((function(e,n,r){t.composite(e.composePic,e.x*O,e.y*O),r.length===n+1&&te(t)}))}))},te=function(){var e=Object(s.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M("Converting to base 64..."),n.quality(60),e.next=4,n.getBase64Async(b.a.MIME_JPEG);case 4:t=e.sent,M("Downloading..."),Object(p.triggerBase64Download)(t,"Multipic-".concat((new Date).getTime())),M(!1);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return a.a.createElement(A,{working:T},T&&a.a.createElement(P,null,a.a.createElement("span",null,T)),a.a.createElement(B,{style:{marginTop:0}},"Multipic"),a.a.createElement(q,null,a.a.createElement(I,null,"Input images"),a.a.createElement(U,{htmlFor:"file-upload-input"},"Select images"),a.a.createElement("input",{id:"file-upload-input",type:"file",multiple:!0,onChange:function(e){return N(e.target.files,"input")}}),(null===d||void 0===d?void 0:d.length)>0&&a.a.createElement(D,null,null===d||void 0===d?void 0:d.map((function(n,t){return a.a.createElement(G,{key:"ip-".concat(t),src:n.original,onClick:function(){var n=d.filter((function(e,n){return t!==n}));g(n),e.current=n}})})))),a.a.createElement(q,null,a.a.createElement(I,null,"Reference image"),a.a.createElement(U,{htmlFor:"file-upload-ref"},"Select image"),a.a.createElement("input",{id:"file-upload-ref",type:"file",onChange:function(e){return N(e.target.files,"ref")}}),i&&a.a.createElement("div",null,a.a.createElement("br",null),a.a.createElement(G,{src:i,style:{width:200,height:200},onClick:function(){return o()}}))),a.a.createElement(q,null,a.a.createElement(I,null,"Parameters"),a.a.createElement(F,null,a.a.createElement("label",null,"Reduction ratio"),a.a.createElement(K,{onClick:function(){M(" "),_({visible:!0,text:"This ratio will divide the size of the reference size. Per example, a 1000*800 image with a reduction ratio of 10 will have 100*80 pixels substituted with your input images",cancelText:"Umh, if you say so",okText:"OK!",fn:function(){_({visible:!1}),M(!1)}})}},a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"10 10 150 150",height:"25",width:"25",version:"1.0"},a.a.createElement("g",{fill:"#4b4b4b"},a.a.createElement("path",{d:"m80 15c-35.88 0-65 29.12-65 65s29.12 65 65 65 65-29.12 65-65-29.12-65-65-65zm0 10c30.36 0 55 24.64 55 55s-24.64 55-55 55-55-24.64-55-55 24.64-55 55-55z"}),a.a.createElement("path",{d:"m57.373 18.231a9.3834 9.1153 0 1 1 -18.767 0 9.3834 9.1153 0 1 1 18.767 0z",transform:"matrix(1.1989 0 0 1.2342 21.214 28.75)"}),a.a.createElement("path",{d:"m90.665 110.96c-0.069 2.73 1.211 3.5 4.327 3.82l5.008 0.1v5.12h-39.073v-5.12l5.503-0.1c3.291-0.1 4.082-1.38 4.327-3.82v-30.813c0.035-4.879-6.296-4.113-10.757-3.968v-5.074l30.665-1.105"})))),a.a.createElement("input",{value:w,onChange:function(e){return E(e.target.value)},type:"number"})),a.a.createElement(F,null,a.a.createElement("label",null,"Square size"),a.a.createElement(K,{onClick:function(){M(" "),_({visible:!0,text:"This is the size your input images will have in the output image. Per example, with a square size of 35, each one of the pixels of the reduced reference image will be substituted with an input image with a size of 35*35px",cancelText:"I dunno...",okText:"Gotcha!",fn:function(){_({visible:!1}),M(!1)}})}},a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"10 10 150 150",height:"25",width:"25",version:"1.0"},a.a.createElement("g",{fill:"#4b4b4b"},a.a.createElement("path",{d:"m80 15c-35.88 0-65 29.12-65 65s29.12 65 65 65 65-29.12 65-65-29.12-65-65-65zm0 10c30.36 0 55 24.64 55 55s-24.64 55-55 55-55-24.64-55-55 24.64-55 55-55z"}),a.a.createElement("path",{d:"m57.373 18.231a9.3834 9.1153 0 1 1 -18.767 0 9.3834 9.1153 0 1 1 18.767 0z",transform:"matrix(1.1989 0 0 1.2342 21.214 28.75)"}),a.a.createElement("path",{d:"m90.665 110.96c-0.069 2.73 1.211 3.5 4.327 3.82l5.008 0.1v5.12h-39.073v-5.12l5.503-0.1c3.291-0.1 4.082-1.38 4.327-3.82v-30.813c0.035-4.879-6.296-4.113-10.757-3.968v-5.074l30.665-1.105"})))),a.a.createElement("input",{value:O,onChange:function(e){return k(e.target.value)},type:"number"}))),a.a.createElement("br",null),a.a.createElement(J,{style:{marginTop:"1em"},onClick:function(){return ee()}},"Let's go!"),$.visible&&a.a.createElement(W,null,a.a.createElement(I,null,$.text),a.a.createElement(H,null,$.fn&&a.a.createElement(J,{style:{marginRight:10},onClick:function(){return $.fn()}},$.okText||"Continue"),a.a.createElement(J,{onClick:function(){_({visible:!1}),M(!1)}},$.cancelText||"Cancel"))),a.a.createElement(L,null,a.a.createElement("p",null,"2020 -\xa0",a.a.createElement("a",{href:"https://alhill.dev"},"Al Hill")),a.a.createElement("p",null,"The source code of this application can be downloaded\xa0",a.a.createElement("a",{href:"https://github.com/alhill/multipic"},"here"),". Use it wisely.")))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement($,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[23,1,2]]]);
//# sourceMappingURL=main.d635c0da.chunk.js.map